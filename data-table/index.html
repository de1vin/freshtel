<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Table</title>
    <style>
        .data-table-form {
            position: sticky;
            top: 0;
        }
        .data-table-form input {
            width: calc(100% - 10px);
            min-width: auto;
        }
        .data-table-content{
            width: 100%;
            border-collapse: collapse;
        }
        .data-table-content td {
            padding: 5px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
        .data-table-header {
            width: 100%;
            background: #f0f0f0;
            border-collapse: collapse;
            margin-bottom: 10px;
        }
        .data-table-header th {
            padding: 5px;
            box-sizing: border-box;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
<div class="data-table-container">
    <form action="table-data.html" class="data-table-form">
    <table class="data-table-header">
        <tr>
            <th >column 1</th>
            <th>column 2</th>
            <th>column 3</th>
        </tr>
        <tr>
            <th><input type="text" name="input_1" placeholder="filter"></th>
            <th><input type="text" name="input_2" placeholder="second filter"></th>
            <th><input type="text" name="input_3" placeholder="last filter"></th>
        </tr>
    </table>
    </form>
    <table class="data-table-content">
        <tr>
            <td >content1</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content1</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content1</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content1</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
        <tr>
            <td>content</td>
            <td>some content</td>
            <td>last column content</td>
        </tr>
    </table>
</div>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function(){
        const filterForm = document.querySelector('.data-table-form');
        const contentTable = document.querySelector('.data-table-content');

        Array.from(filterForm.elements).forEach(element => {
            element.addEventListener('change', fetchData, false);
        });

        window.addEventListener('resize', updateHeader);

        updateHeader();

        function fetchData() {
            const action = filterForm.getAttribute('action');
            const data = {};
            Array.from(filterForm.elements).forEach(element => {
                data[element.name] = element.value;
            });
            console.log(data);
            axios.get(action, {params: data})
                .then(function (response) {
                    let parser = new DOMParser;
                    let doc = parser.parseFromString(response.data, 'text/html');
                    let newContent = doc.querySelector('.data-table-content');
                    if (newContent) {
                        contentTable.innerHTML = newContent.innerHTML
                        updateHeader();
                    }
                }).catch(function (error) {
                    console.log(error);
                })
                .finally(function () {
                    console.log('finish');
                });
        }

        function updateHeader() {
            const firstHeaderRow = document.querySelectorAll('table.data-table-header tr:first-child th');
            const firstDataRow = document.querySelectorAll('table.data-table-content tr:first-child td');

            if (firstHeaderRow.length !== firstDataRow.length) {
                console.log(firstHeaderRow.length, firstDataRow.length, 'Mismatch number of columns');
                return;
            }

            for (let i = 0; i < firstDataRow.length; i++) {
                let columnWidth = firstDataRow[i].clientWidth;
                firstHeaderRow[i].style.width = columnWidth + 'px';
            }
        }
    });
</script>
</body>
</html>
